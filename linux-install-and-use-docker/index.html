<!DOCTYPE html><html lang="cn_ZH"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="gatsby-theme" content="@lekoarts/gatsby-theme-minimal-blog"/><meta data-react-helmet="true" name="twitter:creator" content="@simonyang"/><meta data-react-helmet="true" name="twitter:image:alt" content="这是一篇旧的 dokcer 笔记，大部分内容是基于  Docker Desktop for Windows  写的，但也适用于其他平台。 安装 Docker 先决条件 64 位系统 Linux 内核大于 3.8 内核必须支持并开启 cgroup 和命名空间（namespace…"/><meta data-react-helmet="true" name="twitter:image" content="https://yangxuewu.com/banner.jpg"/><meta data-react-helmet="true" name="twitter:description" content="这是一篇旧的 dokcer 笔记，大部分内容是基于  Docker Desktop for Windows  写的，但也适用于其他平台。 安装 Docker 先决条件 64 位系统 Linux 内核大于 3.8 内核必须支持并开启 cgroup 和命名空间（namespace…"/><meta data-react-helmet="true" name="twitter:url" content="https://yangxuewu.com/linux-install-and-use-docker"/><meta data-react-helmet="true" name="twitter:title" content="Linux 安装和使用 Docker 笔记"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" property="og:image:alt" content="这是一篇旧的 dokcer 笔记，大部分内容是基于  Docker Desktop for Windows  写的，但也适用于其他平台。 安装 Docker 先决条件 64 位系统 Linux 内核大于 3.8 内核必须支持并开启 cgroup 和命名空间（namespace…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:image" content="https://yangxuewu.com/banner.jpg"/><meta data-react-helmet="true" property="og:description" content="这是一篇旧的 dokcer 笔记，大部分内容是基于  Docker Desktop for Windows  写的，但也适用于其他平台。 安装 Docker 先决条件 64 位系统 Linux 内核大于 3.8 内核必须支持并开启 cgroup 和命名空间（namespace…"/><meta data-react-helmet="true" property="og:url" content="https://yangxuewu.com/linux-install-and-use-docker"/><meta data-react-helmet="true" property="og:title" content="Linux 安装和使用 Docker 笔记"/><meta data-react-helmet="true" name="image" content="https://yangxuewu.com/banner.jpg"/><meta data-react-helmet="true" name="description" content="这是一篇旧的 dokcer 笔记，大部分内容是基于  Docker Desktop for Windows  写的，但也适用于其他平台。 安装 Docker 先决条件 64 位系统 Linux 内核大于 3.8 内核必须支持并开启 cgroup 和命名空间（namespace…"/><meta name="generator" content="Gatsby 4.5.4"/><style data-href="/styles.84a0f715c65899620506.css" data-identity="gatsby-global-css">/*
! tailwindcss v3.0.18 | MIT License | https://tailwindcss.com
*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}html{-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5;-moz-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-size:100%;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}*,:after,:before{--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.m-1{margin:.25rem}.cursor-pointer{cursor:pointer}.rounded-full{border-radius:9999px}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}.px-2{padding-left:.5rem;padding-right:.5rem}.text-sm{font-size:.875rem;line-height:1.25rem}.font-bold{font-weight:700}.leading-loose{line-height:2}.shadow{--tw-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}p{line-height:300%}.hover\:bg-gray-300:hover{--tw-bg-opacity:1;background-color:rgb(209 213 219/var(--tw-bg-opacity))}</style><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><title data-react-helmet="true">Linux 安装和使用 Docker 笔记 | BEIHAI Blog</title><link data-react-helmet="true" rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link data-react-helmet="true" rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&amp;display=swap"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="192x192" href="/android-chrome-192x192.png"/><link rel="apple-touch-icon" sizes="512x512" href="/android-chrome-512x512.png"/><link rel="alternate" type="application/rss+xml" title="Minimal Blog - @lekoarts/gatsby-theme-minimal-blog" href="/rss.xml"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-PLS9BCG683"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-PLS9BCG683', {"send_page_view":false});
      }
      </script><link as="script" rel="preload" href="/webpack-runtime-050af6b145167609215a.js"/><link as="script" rel="preload" href="/framework-de026f80c4152d2570ec.js"/><link as="script" rel="preload" href="/app-15bb8988e3d4ff32065b.js"/><link as="script" rel="preload" href="/076b648d06f94fa0e68f4094bcf9c1a72c93f983-bdeab7b9cef700a010e4.js"/><link as="script" rel="preload" href="/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-0ba29a80fd0bb999f086.js"/><link as="fetch" rel="preload" href="/page-data/linux-install-and-use-docker/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2744905544.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3090400250.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/318001574.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.documentElement.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion="css-global 1yc3m30">html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#e2e8f0;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}html.theme-ui-__default,.theme-ui-__default html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#e2e8f0;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;}html.theme-ui-dark,.theme-ui-dark html{--theme-ui-colors-text:#cbd5e0;--theme-ui-colors-primary:#9f7aea;--theme-ui-colors-secondary:#7f8ea3;--theme-ui-colors-toggleIcon:#cbd5e0;--theme-ui-colors-background:#1A202C;--theme-ui-colors-heading:#fff;--theme-ui-colors-divide:#2d3748;--theme-ui-colors-muted:#2d3748;}</style><style data-emotion="css-global qdqg8g">*{box-sizing:border-box;}html{font-family:'Noto Sans SC',sans-serif;line-height:2;font-weight:400;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);margin:0;padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}body{margin:0;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global h7esfd">*{box-sizing:inherit;}html{-webkit-text-size-adjust:100%;}img{border-style:none;}pre{font-family:monospace;font-size:1em;}[hidden]{display:none;}::selection{background-color:var(--theme-ui-colors-text);color:var(--theme-ui-colors-background);}a{-webkit-transition:all 0.3s ease-in-out;transition:all 0.3s ease-in-out;color:text;}</style><style data-emotion="css 1gq7j3t">.css-1gq7j3t{border:0;clip:react(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;overflow:hidden;position:absolute;}.css-1gq7j3t:focus{padding:1rem;position:fixed;top:15px;left:15px;background-color:var(--theme-ui-colors-heading);color:var(--theme-ui-colors-background);z-index:1;width:auto;height:auto;clip:auto;-webkit-text-decoration:none;text-decoration:none;}</style><a href="#skip-nav" data-skip-link="true" class="css-1gq7j3t">Skip to content</a><style data-emotion="css 1jrqzhj">.css-1jrqzhj{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:container;margin-left:auto;margin-right:auto;padding:1rem;max-width:1024px;}@media screen and (min-width: 640px){.css-1jrqzhj{padding:2rem;}}</style><div class="css-1jrqzhj"><style data-emotion="css egutgn">.css-egutgn{margin-bottom:4rem;}@media screen and (min-width: 640px){.css-egutgn{margin-bottom:8rem;}}</style><header class="css-egutgn"><style data-emotion="css 1xwyizx">.css-1xwyizx{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><style data-emotion="css 10klvkd">.css-10klvkd{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><div class="css-10klvkd"><style data-emotion="css uxjqfw">.css-uxjqfw{color:var(--theme-ui-colors-heading);-webkit-text-decoration:none;text-decoration:none;}</style><a aria-label="BEIHAI Blog - Back to home" class="css-uxjqfw" href="/"><style data-emotion="css 102q2va">.css-102q2va{margin-top:0;margin-bottom:0;font-weight:500;font-size:1.5rem;}@media screen and (min-width: 640px){.css-102q2va{font-size:1.875rem;}}</style><div class="css-102q2va">BEIHAI Blog</div></a><style data-emotion="css zut31r">.css-zut31r{opacity:0.65;position:relative;border-radius:5px;width:40px;height:25px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;border:none;outline:none;background:none;cursor:pointer;padding:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;}.css-zut31r:hover,.css-zut31r:focus{opacity:1;}</style><button type="button" aria-label="Activate Dark Mode" title="Activate Dark Mode" class="css-zut31r"><style data-emotion="css 1m6u41m">.css-1m6u41m{position:relative;width:24px;height:24px;border-radius:50%;border:none;background-color:var(--theme-ui-colors-transparent);-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1);-webkit-transition:all 0.45s ease;transition:all 0.45s ease;overflow:hidden;box-shadow:inset 8px -8px 0px 0px var(--theme-ui-colors-toggleIcon);}.css-1m6u41m:before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:none;border-radius:50%;-webkit-transform:translate(0, 0);-moz-transform:translate(0, 0);-ms-transform:translate(0, 0);transform:translate(0, 0);opacity:1;-webkit-transition:-webkit-transform 0.45s ease;transition:transform 0.45s ease;}.css-1m6u41m:after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0 0 -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon),0 23px 0 var(--theme-ui-colors-toggleIcon),23px 0 0 var(--theme-ui-colors-toggleIcon),-23px 0 0 var(--theme-ui-colors-toggleIcon),15px 15px 0 var(--theme-ui-colors-toggleIcon),-15px 15px 0 var(--theme-ui-colors-toggleIcon),15px -15px 0 var(--theme-ui-colors-toggleIcon),-15px -15px 0 var(--theme-ui-colors-toggleIcon);-webkit-transform:scale(0);-moz-transform:scale(0);-ms-transform:scale(0);transform:scale(0);-webkit-transition:all 0.35s ease;transition:all 0.35s ease;}</style><div class="css-1m6u41m"></div></button></div><style data-emotion="css fp1v3n">.css-fp1v3n{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:var(--theme-ui-colors-divide);padding-bottom:1rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:1rem;color:var(--theme-ui-colors-secondary);-webkit-box-flex-flow:wrap;-webkit-flex-flow:wrap;-ms-flex-flow:wrap;flex-flow:wrap;}.css-fp1v3n a{color:var(--theme-ui-colors-secondary);}.css-fp1v3n a:hover{color:var(--theme-ui-colors-heading);}</style><div class="css-fp1v3n"><style data-emotion="css quiqiw">.css-quiqiw{font-size:1rem;}.css-quiqiw a:not(:last-of-type){margin-right:4rem;}@media screen and (min-width: 640px){.css-quiqiw{font-size:18px;}}.css-quiqiw .active{color:var(--theme-ui-colors-heading);}</style><nav class="css-quiqiw"><style data-emotion="css bpdkdn">.css-bpdkdn{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-bpdkdn:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="css-bpdkdn" href="/">Home</a><a class="css-bpdkdn" href="/blog">Blog</a><a class="css-bpdkdn" href="/tags">Tags</a><a class="css-bpdkdn" href="/about">About</a></nav></div></header><style data-emotion="css 1c3blfx">.css-1c3blfx [data-name='live-editor']{font-size:1rem;}.css-1c3blfx [data-name='live-editor'] textarea,.css-1c3blfx [data-name='live-editor'] pre{padding:1rem!important;}.css-1c3blfx [data-name='live-preview']{padding:calc(0.5rem + 10px)!important;background-color:#d2c7ec;}.css-1c3blfx .prism-code{font-size:1rem;padding:2rem 1rem 1rem 1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width: 640px){.css-1c3blfx .prism-code{font-size:1rem;}}@media screen and (min-width: 768px){.css-1c3blfx .prism-code{font-size:1.25rem;}}.css-1c3blfx .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-1c3blfx .gatsby-highlight[data-language=''] .prism-code,.css-1c3blfx .gatsby-highlight[data-language='noLineNumbers'] .prism-code{padding-top:1rem;}.css-1c3blfx .token{display:inline-block;}.css-1c3blfx p>code,.css-1c3blfx li>code{background-color:var(--theme-ui-colors-gray-2);color:var(--theme-ui-colors-gray-8);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:2px;}.css-1c3blfx .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;background-color:rgb(1, 22, 39);border-radius:2px;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1c3blfx .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1c3blfx .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1c3blfx .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-1c3blfx .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-1c3blfx .gatsby-highlight pre code{float:left;min-width:100%;}.css-1c3blfx .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 0.25rem 0.25rem;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;top:0;}.css-1c3blfx .gatsby-highlight pre[class~="language-javascript"]:before,.css-1c3blfx .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1c3blfx .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1c3blfx .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1c3blfx .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-1c3blfx .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-py"]:before,.css-1c3blfx .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white);}.css-1c3blfx .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-1c3blfx .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-1c3blfx .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-1c3blfx .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-1c3blfx .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-1c3blfx .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-1c3blfx .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-1c3blfx .gatsby-highlight pre[class~='language-json']:before,.css-1c3blfx .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-1c3blfx .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-1c3blfx .gatsby-highlight>code[class*="language-"],.css-1c3blfx .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1c3blfx .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-1c3blfx .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary);}.css-1c3blfx .gatsby-highlight pre::-webkit-scrollbar-track{background:rgb(1, 22, 39);}.css-1c3blfx .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-1c3blfx .code-title{background-color:#d2c7ec;color:var(--theme-ui-colors-black);font-size:0.875rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1c3blfx .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1c3blfx .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1c3blfx .code-title{margin-left:-1rem;margin-right:-1rem;}}.css-1c3blfx [data-name='live-preview'],.css-1c3blfx [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}@media screen and (min-width: 640px){.css-1c3blfx [data-name='live-preview'],.css-1c3blfx [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}}@media screen and (min-width: 768px){.css-1c3blfx [data-name='live-preview'],.css-1c3blfx [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1.25rem;}}@media screen and (min-width: 1024px){.css-1c3blfx [data-name='live-preview'],.css-1c3blfx [data-name='live-editor']{margin-left:-1rem;margin-right:-1rem;}}.css-1c3blfx .token-line{padding-right:1rem;}.css-1c3blfx .highlight-line{background-color:rgb(2, 55, 81);border-left:4px solid rgb(2, 155, 206);}.css-1c3blfx .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-1c3blfx .react-live-wrapper{position:relative;}.css-1c3blfx .react-live-wrapper .code-copy-button{right:0;}@media screen and (min-width: 640px){.css-1c3blfx .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 768px){.css-1c3blfx .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 1024px){.css-1c3blfx .react-live-wrapper .code-copy-button{right:-1rem;}}</style><style data-emotion="css albdeh">.css-albdeh{box-sizing:border-box;margin:0;min-width:0;}.css-albdeh [data-name='live-editor']{font-size:1rem;}.css-albdeh [data-name='live-editor'] textarea,.css-albdeh [data-name='live-editor'] pre{padding:1rem!important;}.css-albdeh [data-name='live-preview']{padding:calc(0.5rem + 10px)!important;background-color:#d2c7ec;}.css-albdeh .prism-code{font-size:1rem;padding:2rem 1rem 1rem 1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width: 640px){.css-albdeh .prism-code{font-size:1rem;}}@media screen and (min-width: 768px){.css-albdeh .prism-code{font-size:1.25rem;}}.css-albdeh .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-albdeh .gatsby-highlight[data-language=''] .prism-code,.css-albdeh .gatsby-highlight[data-language='noLineNumbers'] .prism-code{padding-top:1rem;}.css-albdeh .token{display:inline-block;}.css-albdeh p>code,.css-albdeh li>code{background-color:var(--theme-ui-colors-gray-2);color:var(--theme-ui-colors-gray-8);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:2px;}.css-albdeh .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;background-color:rgb(1, 22, 39);border-radius:2px;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-albdeh .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-albdeh .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-albdeh .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-albdeh .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-albdeh .gatsby-highlight pre code{float:left;min-width:100%;}.css-albdeh .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 0.25rem 0.25rem;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;top:0;}.css-albdeh .gatsby-highlight pre[class~="language-javascript"]:before,.css-albdeh .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-albdeh .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-albdeh .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-albdeh .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-albdeh .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-py"]:before,.css-albdeh .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white);}.css-albdeh .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-albdeh .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-albdeh .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-albdeh .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-albdeh .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-albdeh .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-albdeh .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-albdeh .gatsby-highlight pre[class~='language-json']:before,.css-albdeh .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-albdeh .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-albdeh .gatsby-highlight>code[class*="language-"],.css-albdeh .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-albdeh .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-albdeh .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary);}.css-albdeh .gatsby-highlight pre::-webkit-scrollbar-track{background:rgb(1, 22, 39);}.css-albdeh .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-albdeh .code-title{background-color:#d2c7ec;color:var(--theme-ui-colors-black);font-size:0.875rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-albdeh .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-albdeh .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-albdeh .code-title{margin-left:-1rem;margin-right:-1rem;}}.css-albdeh [data-name='live-preview'],.css-albdeh [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}@media screen and (min-width: 640px){.css-albdeh [data-name='live-preview'],.css-albdeh [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}}@media screen and (min-width: 768px){.css-albdeh [data-name='live-preview'],.css-albdeh [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1.25rem;}}@media screen and (min-width: 1024px){.css-albdeh [data-name='live-preview'],.css-albdeh [data-name='live-editor']{margin-left:-1rem;margin-right:-1rem;}}.css-albdeh .token-line{padding-right:1rem;}.css-albdeh .highlight-line{background-color:rgb(2, 55, 81);border-left:4px solid rgb(2, 155, 206);}.css-albdeh .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-albdeh .react-live-wrapper{position:relative;}.css-albdeh .react-live-wrapper .code-copy-button{right:0;}@media screen and (min-width: 640px){.css-albdeh .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 768px){.css-albdeh .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 1024px){.css-albdeh .react-live-wrapper .code-copy-button{right:-1rem;}}</style><main id="skip-nav" class=" css-albdeh"><style data-emotion="css 1aue9xx">.css-1aue9xx{box-sizing:border-box;margin:0;min-width:0;font-family:inherit;font-weight:700;line-height:1.25;font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:2.25rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-1aue9xx{font-size:3rem;}}@media screen and (min-width: 768px){.css-1aue9xx{font-size:3rem;}}@media screen and (min-width: 1024px){.css-1aue9xx{font-size:4rem;}}</style><h1 class="css-1aue9xx">Linux 安装和使用 Docker 笔记</h1><style data-emotion="css 15ce8we">.css-15ce8we{color:var(--theme-ui-colors-secondary);margin-top:1rem;font-size:1rem;}.css-15ce8we a{color:var(--theme-ui-colors-secondary);}@media screen and (min-width: 640px){.css-15ce8we{font-size:1rem;}}@media screen and (min-width: 768px){.css-15ce8we{font-size:1.25rem;}}</style><p class="css-15ce8we"><time>2022-02-21</time>   <a class="css-bpdkdn" href="/tags/notes"><span class="m-1 bg-gray-200 hover:bg-gray-300 rounded-full px-2 font-bold text-sm leading-loose cursor-pointer">#<!-- -->notes</span></a>, <a class="css-bpdkdn" href="/tags/docker"><span class="m-1 bg-gray-200 hover:bg-gray-300 rounded-full px-2 font-bold text-sm leading-loose cursor-pointer">#<!-- -->docker</span></a>, <a class="css-bpdkdn" href="/tags/linux"><span class="m-1 bg-gray-200 hover:bg-gray-300 rounded-full px-2 font-bold text-sm leading-loose cursor-pointer">#<!-- -->linux</span></a>   <span>2<!-- --> min read</span></p><style data-emotion="css b56ay0">.css-b56ay0{margin-top:4rem;margin-bottom:4rem;}.css-b56ay0 .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;box-shadow:rgba(0, 0, 0, 0.15) 0px 32px 32px 0px,rgba(0, 0, 0, 0.15) 0px 16px 16px 0px,rgba(0, 0, 0, 0.15) 0px 8px 8px 0px,rgba(0, 0, 0, 0.15) 0px 4px 4px 0px;}@media screen and (min-width: 640px){.css-b56ay0 .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;}}@media screen and (min-width: 768px){.css-b56ay0 .gatsby-resp-image-wrapper{margin-top:4rem;margin-bottom:4rem;}}</style><section class="css-b56ay0"><style data-emotion="css 1ioa6cd">.css-1ioa6cd{border-left-color:var(--theme-ui-colors-primary);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1ioa6cd p{font-style:italic;}</style><blockquote class="css-1ioa6cd"><style data-emotion="css 1msd9hy">.css-1msd9hy{font-size:1rem;letter-spacing:-0.003em;line-height:2;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width: 640px){.css-1msd9hy{font-size:1rem;}}@media screen and (min-width: 768px){.css-1msd9hy{font-size:1.25rem;}}.css-1msd9hy code{font-size:1rem;}</style><p class="css-1msd9hy">这是一篇旧的 dokcer 笔记，大部分内容是基于 <style data-emotion="css 1bw77fa">.css-1bw77fa{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1bw77fa:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://docs.docker.com/desktop/windows/install/" class="css-1bw77fa">Docker Desktop for Windows</a> 写的，但也适用于其他平台。</p></blockquote><style data-emotion="css kih3f7">.css-kih3f7{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-kih3f7{font-size:2.25rem;}}@media screen and (min-width: 768px){.css-kih3f7{font-size:2.25rem;}}@media screen and (min-width: 1024px){.css-kih3f7{font-size:3rem;}}</style><h2 class="css-kih3f7">安装 Docker 先决条件</h2><style data-emotion="css edo1j3">.css-edo1j3 li{font-size:1rem;letter-spacing:-0.003em;line-height:2;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width: 640px){.css-edo1j3 li{font-size:1rem;}}@media screen and (min-width: 768px){.css-edo1j3 li{font-size:1.25rem;}}</style><ul class="css-edo1j3"><li class="css-0">64 位系统</li><li class="css-0">Linux 内核大于 3.8</li><li class="css-0">内核必须支持并开启 cgroup 和命名空间（namespace）</li></ul><h2 class="css-kih3f7">在 Ubuntu 和 Debian 中安装 Docker</h2><blockquote class="css-1ioa6cd"><p class="css-1msd9hy">安装时还是参考<a href="https://docs.docker.com/engine/install/ubuntu/" class="css-1bw77fa">官网</a>，这部分的笔记是很久之前记录的，现在可能已经不能使用了，但是还是保留下来，做个记录吧。</p></blockquote><ol class="css-edo1j3"><li class="css-0">检查内核版本</li></ol><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><style data-emotion="css 1ifvhg3">.css-1ifvhg3{background-color:rgba(107,70,193,0.2);border:none;color:var(--theme-ui-colors-gray-2);cursor:pointer;font-size:14px;font-family:'Noto Sans SC',sans-serif;letter-spacing:0.025rem;-webkit-transition:default;transition:default;position:absolute;top:0;right:0;z-index:1;border-radius:0 0 0 0.25rem;padding:0.25rem 0.6rem;}@media screen and (min-width: 640px){.css-1ifvhg3{font-size:14px;}}@media screen and (min-width: 768px){.css-1ifvhg3{font-size:16px;}}.css-1ifvhg3[disabled]{cursor:not-allowed;}.css-1ifvhg3:not([disabled]):hover{background-color:var(--theme-ui-colors-primary);color:var(--theme-ui-colors-white);}</style><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<style data-emotion="css 15vf505">.css-15vf505{border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px;}</style><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token function" style="color:rgb(130, 170, 255)">uname</span><span class="token plain"> -a</span></div></code></pre></div><ol start="2" class="css-edo1j3"><li class="css-0">升级系统到最新</li></ol><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#  检查更新</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> update</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#  安装内核</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> linux-headers-x.xx.x-xx-generic</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#  加载新内核</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">update-grub</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#  重启</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">reboot</span></div></code></pre></div><ol start="3" class="css-edo1j3"><li class="css-0">检查 Device Mapper 存储驱动</li></ol><p class="css-1msd9hy">检查 Device Mapper</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token function" style="color:rgb(130, 170, 255)">ls</span><span class="token plain"> -l /sys/class/misc/device-mapper</span></div></code></pre></div><p class="css-1msd9hy">在 /proc/devices 文件中检查是否有 device-mapper 条目</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> device-mapper /proc/devices</span></div></code></pre></div><p class="css-1msd9hy">如果无 device-mapper 相关信息，尝试加载 dm_mod 模块</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> modprode dm_mod</span></div></code></pre></div><ol start="4" class="css-edo1j3"><li class="css-0">安装 Docker</li></ol><p class="css-1msd9hy">（1） Install packages to allowapt to use a repository over HTTPS:</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">  apt-transport-https </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">  ca-certificates </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">  software-properties-common</span></div></code></pre></div><p class="css-1msd9hy">（2） Add Docker&#x27;s official GPG key:</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -fsSLhttps://download.docker.com/linux/ubuntu/gpg </span><span class="token operator" style="color:rgb(127, 219, 202)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> apt-key </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> -</span></div></code></pre></div><p class="css-1msd9hy">Verify fingerprint</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> apt-key fingerprint 0EBFCD88</span></div></code></pre></div><p class="css-1msd9hy">（3）use stable repository</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> add-apt-repository </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">  </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu\</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token string" style="color:rgb(173, 219, 103)">  </span><span class="token string variable" style="color:rgb(214, 222, 235)">$(</span><span class="token string variable" style="color:rgb(214, 222, 235)">lsb_release -cs</span><span class="token string variable" style="color:rgb(214, 222, 235)">)</span><span class="token string" style="color:rgb(173, 219, 103)"> \</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token string" style="color:rgb(173, 219, 103)">  stable&quot;</span></div></code></pre></div><p class="css-1msd9hy">（4）安装 Docker 软件包</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> docker-engine</span></div></code></pre></div><p class="css-1msd9hy">（5）确认 Docker 应正常安装并运行</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> docker info</span></div></code></pre></div><ol start="5" class="css-edo1j3"><li class="css-0">Docker 中使用 UFW(Uncomplicated Firewall)</li></ol><p class="css-1msd9hy">修改 /etc/default/ufw 文件</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#  原始</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">DEFAULT_FORWARD_POLICY</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;DROP&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#  修改为</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">DEFAULT_FORWARD_POLICY</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;ACCEPT&quot;</span></div></code></pre></div><p class="css-1msd9hy">重新加载 UFW 防火墙</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> ufw reload</span></div></code></pre></div><h2 class="css-kih3f7">docker 常用命令</h2><p class="css-1msd9hy">列出本机所有 image 文件</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker image </span><span class="token function" style="color:rgb(130, 170, 255)">ls</span></div></code></pre></div><p class="css-1msd9hy">删除 image 文件</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker image </span><span class="token function" style="color:rgb(130, 170, 255)">rm</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">imageName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></code></pre></div><p class="css-1msd9hy">列出本机正在运行的容器</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker container </span><span class="token function" style="color:rgb(130, 170, 255)">ls</span></div></code></pre></div><p class="css-1msd9hy">列出本机所有容器，包括终止运行的容器</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker container </span><span class="token function" style="color:rgb(130, 170, 255)">ls</span><span class="token plain"> --all</span></div></code></pre></div><p class="css-1msd9hy">终止运行容器</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker container </span><span class="token function" style="color:rgb(130, 170, 255)">kill</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">containerId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></code></pre></div><p class="css-1msd9hy">删除容器</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker container </span><span class="token function" style="color:rgb(130, 170, 255)">rm</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">containerId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></code></pre></div><p class="css-1msd9hy">启动容器</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker container start containerId</span></div></code></pre></div><p class="css-1msd9hy">停止运行容器</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker container stop containerId</span></div></code></pre></div><p class="css-1msd9hy">查看容器输出</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker container logs containerId</span></div></code></pre></div><p class="css-1msd9hy">进入正在运行的容器</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker container </span><span class="token builtin class-name" style="color:rgb(255, 203, 139)">exec</span><span class="token plain"> -it constainerId /bin/bash</span></div></code></pre></div><p class="css-1msd9hy">从正在运行的容器里将文件拷贝到本机</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker container </span><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> constainerId:</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">/path/to/file</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(255, 203, 139)">.</span></div></code></pre></div><h2 class="css-kih3f7">Dockerfile 文件</h2><p class="css-1msd9hy">Dockerfile 是一个用来配置生成 image 文件的文本文件。</p><p class="css-1msd9hy"><code class="css-0">.dockerignore</code> 文件写入要排除在 image 文件外的文件/文件夹。</p><p class="css-1msd9hy">Dockerfile 文件内容示例：</p><div class="gatsby-highlight" data-language="dockerfile"><pre class="prism-code language-dockerfile" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-dockerfile"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">FROM node:8.4</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">COPY . /app</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">WORKDIR /app</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">RUN [&quot;npm&quot;, &quot;install&quot;]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">EXPOSE 3000/tcp</span></div></code></pre></div><ul class="css-edo1j3"><li class="css-0">FROM node:8.4 ---&gt; image 文件继承的 image，冒号表示继承 image 的标签</li><li class="css-0">COPY . /app ---&gt; 将当前目录下除 .dockerignore 排除的路径的所有文件，都拷贝到 image 的 /app 目录</li><li class="css-0">WORKDIR /app ---&gt; 指定接下来的工作路径为 /app</li><li class="css-0">RUN <!-- -->[&quot;npm&quot;, &quot;install&quot;]<!-- --> ---&gt; 在 /app 目录下运行 npm install 安装依赖。安装后所有依赖都将打包到 image 文件</li><li class="css-0">EXPOSE 3000/tcp ---&gt; 将容器 3000 端口暴露出来</li></ul><p class="css-1msd9hy">创建 image 文件</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker image build -t </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">imageName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">:tag</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">fileDir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></code></pre></div><p class="css-1msd9hy"><code class="css-0">-t</code> 参数用来指定 image 文件名，文件名后的 <code class="css-0">:tag</code> 为 image 指定标签，如果不指定，默认为 <code class="css-0">latest</code>，fileDir 表示 Dockerfile 所在路径，当前路径就是一个点。</p><p class="css-1msd9hy">如果运行成功，通过 docker image ls  查看新生成的 image 文件。</p><p class="css-1msd9hy">生成容器</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker container run -p </span><span class="token number" style="color:rgb(247, 140, 108)">8000</span><span class="token plain">:3000 -it imageName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">:tag</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> /bin/bash</span></div></code></pre></div><ul class="css-edo1j3"><li class="css-0">-p : 容器的 3000 端口映射到本机的 8000 端口</li><li class="css-0">-it : 容器的 shell 映射到当前的 shell，在本机窗口输入命令会传入容器</li><li class="css-0">imageName<!-- -->[:tag]<!-- --> : image 文件名<!-- -->[:标签]</li><li class="css-0">/bin/bash : 容器启动以后，内部第一个指定的命令，这里是启动 bash，保证用户能够使用 shell</li></ul><p class="css-1msd9hy">CMD 命令</p><p class="css-1msd9hy">在 Dockerfile 中添加 CMD 命令，让容器启动后自动执行命令</p><div class="gatsby-highlight" data-language="dockerfile"><pre class="prism-code language-dockerfile" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-dockerfile"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">FROM node:8.4</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">COPY . /app</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">WORKDIR /app</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">RUN [&quot;npm&quot;, &quot;install&quot;]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">EXPOSE 3000/tcp</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">CMD node demos/01.js</span></div></code></pre></div><p class="css-1msd9hy">RUN 命令与 CMD 命令的区别：</p><p class="css-1msd9hy">RUN 命令在 image 文件构建阶段执行，执行结果打包进入 image 文件；CMD 命令在容器启动后执行。一个 Dockerfile 可以包含多个 RUN 命令，但只能有一个 CMD 命令。</p><p class="css-1msd9hy">指定了 CMD 命令后，docker container run 命令就不能附加命令了（比如 /bin/bash），否则会覆盖 CMD 命令。</p><p class="css-1msd9hy">发布 image 文件</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker image tag imageName </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">username</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">/</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">repository</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">:</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">tag</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></code></pre></div><p class="css-1msd9hy">或</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker image build -t </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">username</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">/</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">repositrory</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">:</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">tag</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(255, 203, 139)">.</span></div></code></pre></div><p class="css-1msd9hy">发布 image 文件</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker image push </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">username</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">/</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">repository</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">:</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">tag</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></code></pre></div><h2 class="css-kih3f7">docker 安装 mysql 及 通过 nodejs 连接数据库</h2><p class="css-1msd9hy">1、安装</p><p class="css-1msd9hy">以 5.7 为例：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker pull mysql:5.7</span></div></code></pre></div><p class="css-1msd9hy">2、创建 mysql 数据库文件存放目录</p><p class="css-1msd9hy">因为 docker 容器不保存数据，管理容器数据也就没有了，所以必须要设置数据存储目录，把数据存在本地磁盘上。例：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> D:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">docker</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">mysql</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> D:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">docker</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">mysqlConf</span></div></code></pre></div><p class="css-1msd9hy">3、启动 mysql 镜像</p><p class="css-1msd9hy">打开 powershell，执行如下命令：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker run -d --rm --name Mysql -v D:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">docker</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">mysql:/var/lib/mysql -v D:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">docker</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">mysqlConf:/etc/mysql/conf.d -e </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">MYSQL_ROOT_PASSWORD</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">123456</span><span class="token plain"> -p </span><span class="token number" style="color:rgb(247, 140, 108)">3306</span><span class="token plain">:3306 mysql:5.7 --character-set-server</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">utf8mb4 --collation-server</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">utf8mb4_unicode_ci</span></div></code></pre></div><p class="css-1msd9hy">说明：</p><ul class="css-edo1j3"><li class="css-0">-d：后台运行</li><li class="css-0">--rm：停止镜像自动删除镜像，如果配置好可以不删除，Windows 最新使用 Dashboard 管理容器，UI 界面会很方便，配置好后不删除。并且  Windows  下使用  Docker Desktop  时使用  Kitematic  管理镜像启停很方便，配置之后就不用删除了。</li><li class="css-0">--name：镜像别名</li><li class="css-0">-v：把本地目录映射到镜像目录</li><li class="css-0">-e：设置环境变量，通过  docker  安装的  mysql  必须设置 MYSQL_ROOT_PASSWORD，否则不能运行。</li><li class="css-0">-p：把本地端口映射到镜像端口，这里最好一致，否则可能有无法连接的问题</li><li class="css-0">--character-set-server  和 --collation-server  设置  mysql  编码，以便识别中文。</li></ul><p class="css-1msd9hy">4、添加远程访问账户</p><del class="css-0">打开 Kitematic  点击运行中的  mysql  镜像，点击  EXEC  图标，弹出命令行界面，输入下面的命令：</del><del class="css-0">mysql -u root -p</del><p class="css-1msd9hy">Linux 输入：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker container </span><span class="token builtin class-name" style="color:rgb(255, 203, 139)">exec</span><span class="token plain"> -it </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">containerId</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"> /bin/bash</span></div></code></pre></div><p class="css-1msd9hy">再输入 <code class="css-0">mysql -u root -p</code></p><p class="css-1msd9hy">按照提示输入 <code class="css-0">root</code> 密码。</p><p class="css-1msd9hy">创建一个新用户：</p><div class="gatsby-highlight" data-language="sql"><pre class="prism-code language-sql" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-sql"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 创建一个用于本地访问的用户</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">USER</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;username&#x27;</span><span class="token variable" style="color:rgb(214, 222, 235)">@&#x27;localhost&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:rgb(127, 219, 202)">BY</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;password&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 创建一个所有网络均可访问的用户</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">USER</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;username&#x27;</span><span class="token variable" style="color:rgb(214, 222, 235)">@&#x27;%&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:rgb(127, 219, 202)">BY</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;password&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 创建一个指定 IP 访问的用户</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">USER</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;username&#x27;</span><span class="token variable" style="color:rgb(214, 222, 235)">@&#x27;IP&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:rgb(127, 219, 202)">BY</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;password&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></code></pre></div><p class="css-1msd9hy">设置新用户权限：</p><div class="gatsby-highlight" data-language="sql"><pre class="prism-code language-sql" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-sql"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token keyword" style="color:rgb(127, 219, 202)">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">ALL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">PRIVILEGES</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">ON</span><span class="token plain"> _</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">_ </span><span class="token keyword" style="color:rgb(127, 219, 202)">TO</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;username&#x27;</span><span class="token variable" style="color:rgb(214, 222, 235)">@&#x27;%&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">WITH</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">OPTION</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 授予用户 testDb 内所有表的所有权限</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">ALL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">PRIVILEGES</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">ON</span><span class="token plain"> testDb</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token operator" style="color:rgb(127, 219, 202)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">TO</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;username&#x27;</span><span class="token variable" style="color:rgb(214, 222, 235)">@&#x27;%&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">WITH</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">OPTION</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">ALL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">PRIVILEGES</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">ON</span><span class="token plain"> testDb</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token operator" style="color:rgb(127, 219, 202)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">TO</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;username&#x27;</span><span class="token variable" style="color:rgb(214, 222, 235)">@&#x27;localhost&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">WITH</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">OPTION</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 刷新用户权限</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">FLUSH </span><span class="token keyword" style="color:rgb(127, 219, 202)">PRIVILEGES</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></code></pre></div><p class="css-1msd9hy">5、通过 nodejs 的 mysql2 模块连接数据库</p><p class="css-1msd9hy">mysql2 用法查看 <a href="https://www.npmjs.com/package/mysql2" class="css-1bw77fa">npm 文档</a>。</p><p class="css-1msd9hy">连接过程中，如果出现以下错误：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">Client does not support authentication protocol requested by server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> consider upgrading MySQL client</span></div></code></pre></div><p class="css-1msd9hy">按照如下方法解决：</p><del class="css-0">在 Kitematic  界面点击  EXEC  进入命令行，然后登录：</del><p class="css-1msd9hy"><code class="css-0">mysql -u root -p</code></p><p class="css-1msd9hy">然后执行以下命令：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">ALTER </span><span class="token environment constant" style="color:rgb(130, 170, 255)">USER</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;root&#x27;</span><span class="token plain">@</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;%&#x27;</span><span class="token plain"> IDENTIFIED WITH mysql_native_password BY </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;your_root_password&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">ALTER </span><span class="token environment constant" style="color:rgb(130, 170, 255)">USER</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;root&#x27;</span><span class="token plain">@</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;localhost&#x27;</span><span class="token plain"> IDENTIFIED WITH mysql_native_password BY </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;your_root_password&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></code></pre></div><p class="css-1msd9hy">再执行以下命令查看是否设置成功，最后再尝试连接。</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">SELECT plugin FROM mysql.user WHERE User </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;root&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></code></pre></div><p class="css-1msd9hy">6、通过 mysql2 获取数据</p><p class="css-1msd9hy">mysql2 支持 promise，获取的数据是一个数据集，如果要获取数据表，只需要取数据集的第一张表（也就是索引为 0  的表）即可。</p><p class="css-1msd9hy">如果要获取一个数据表中数据行数，在使用 COUNT(<!-- -->*<!-- -->)  时最好设置一个别名，否则后续处理数据时会比较麻烦。</p><p class="css-1msd9hy">mysql2  的  query  方法的第一个参数是 SQL 语句，SQL 语句传入的变量可以用 <code class="css-0">?</code> 作为占位符，第二个参数即是传给 SQL 语句变量的参数。</p><h2 class="css-kih3f7">docker 无法打开端口</h2><p class="css-1msd9hy">第一步</p><p class="css-1msd9hy">Disable hyper-v (which will required a couple of restarts)
dism.exe /Online /Disable-Feature:Microsoft-Hyper-V</p><p class="css-1msd9hy">第二步</p><p class="css-1msd9hy">When you finish all the required restarts, reserve the port you want so hyper-v doesn&#x27;t reserve it back
netsh int ipv4 add excludedportrange protocol=tcp startport=50051 numberofports=1</p><p class="css-1msd9hy">第三步</p><p class="css-1msd9hy">Re-Enable hyper-V (which will require a couple of restart)
dism.exe /Online /Enable-Feature:Microsoft-Hyper-V /All</p><h2 class="css-kih3f7">docker 安装 jupyter 镜像容器</h2><ol class="css-edo1j3"><li class="css-0">拉取镜像</li></ol><p class="css-1msd9hy">以 minimal-notebook 镜像为例。</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker pull jupyter/minimal-notebook:latest</span></div></code></pre></div><ol start="2" class="css-edo1j3"><li class="css-0">运行容器</li></ol><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker run --rm -d --name Myjupyter -v D:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">Jupyter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">work:/home/jovyan/work -p </span><span class="token number" style="color:rgb(247, 140, 108)">8888</span><span class="token plain">:8888 -e </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">JUPYTER_ENABLE_LAB</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">yes  jupyter/minimal-notebook:latest</span></div></code></pre></div><ol start="3" class="css-edo1j3"><li class="css-0">所有配置项</li></ol><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker run --rm -d --name Myjupyter --user root -e </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">NB_USER</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">xuewu -e </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">NB_UID</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1000</span><span class="token plain"> -e </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">NB_GID</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token plain"> -e </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">NB_GROUP</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token variable" style="color:rgb(214, 222, 235)">$NB_USER</span><span class="token plain"> -e </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">CHOWN_HOME</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">yes -e </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">GRANT_SUDO</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">yes -e </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">RESTARTABLE</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">yes  -w /home/</span><span class="token variable" style="color:rgb(214, 222, 235)">$NB_USER</span><span class="token plain"> -v D:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">Jupyter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">work:/home/xuewu/work -p </span><span class="token number" style="color:rgb(247, 140, 108)">8888</span><span class="token plain">:8888 -e </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">JUPYTER_ENABLE_LAB</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">yes  jupyter/minimal-notebook:latest</span></div></code></pre></div><h2 class="css-kih3f7">docker 部署 mongodb</h2><ol class="css-edo1j3"><li class="css-0">创建一个 volume</li></ol><p class="css-1msd9hy">volume 的作用是用来存储数据，因为 windows 下 docker 功能限制，不能使用路径挂载的方式将数据库文件挂载到本地磁盘，因此只能使用这种方式。</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker volume create --name</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Your-volume-name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></code></pre></div><ol start="2" class="css-edo1j3"><li class="css-0">运行 mongo 容器</li></ol><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker run --name </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">mongodb-name</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"> -p </span><span class="token number" style="color:rgb(247, 140, 108)">27017</span><span class="token plain">:27017 -v </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Your-volume-name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">:/data/db -d mongo</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">:version</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span></div></code></pre></div><p class="css-1msd9hy">--name:  数据库名字，不加参数则使用随机名</p><p class="css-1msd9hy">-p:  端口，前面是计算机端口，后面是容器上的端口</p><p class="css-1msd9hy">-v:  数据库目录，冒号前是创建的  volume  名，冒号后是容器上的路径</p><p class="css-1msd9hy">-d:  在后台运行</p><p class="css-1msd9hy">mongo:  镜像，后加版本号，不加版本号默认是  latest，最好制定版本号</p><ol start="3" class="css-edo1j3"><li class="css-0">创建管理员：</li></ol><p class="css-1msd9hy">要为 mongodb 加入登录验证，就需要创建登录用户名和密码。</p><p class="css-1msd9hy">进入  mongo  命令行:</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 139)">exec</span><span class="token plain"> -it </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mongodb-name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">mongo</span></div></code></pre></div><p class="css-1msd9hy">进入数据库：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">use database-name</span></div></code></pre></div><p class="css-1msd9hy">执行以下命令：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">db.createUser</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> user: </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;&lt;USER&gt;&#x27;</span><span class="token plain">, pwd: </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;&lt;PASSWORD&gt;&#x27;</span><span class="token plain">, roles: </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> role: </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;readWrite&#x27;</span><span class="token plain">, db: </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;database-name&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></code></pre></div><p class="css-1msd9hy">将 <code class="css-0">&lt;USER&gt;</code> 和 <code class="css-0">&lt;PASSWORD&gt;</code> 内容替换成自己需要的用户名和密码。</p><p class="css-1msd9hy">退出命令行，停止并移除当前容器，然后重新以验证方式开启一个新容器：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker stop mongodb-name</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">docker </span><span class="token function" style="color:rgb(130, 170, 255)">rm</span><span class="token plain"> mongodb-name</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">docker run --name mongodb-name -v mongodata:/data/db -d -p </span><span class="token number" style="color:rgb(247, 140, 108)">27017</span><span class="token plain">:27017 mongo --auth</span></div></code></pre></div><ol start="4" class="css-edo1j3"><li class="css-0">以验证方式连接数据库</li></ol><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">mongodb://user:password@localhost:27017/database-name</span></div></code></pre></div><ol start="5" class="css-edo1j3"><li class="css-0">导入数据</li></ol><p class="css-1msd9hy">首先将数据集 json 或 bson 文件复制到 mongo 容器中：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker </span><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> a.json mongodb-name:/path</span></div></code></pre></div><p class="css-1msd9hy">a.json 的位置可以写入一个 json 或 bson 文件，或者是一个路径，这样就能复制一整个路径下的文件。</p><p class="css-1msd9hy">path 是复制到 mongo 容器中的路径，自己新建一个路径，防止导入的文件弄乱容器目录，也方便下一步数据导入。</p><p class="css-1msd9hy">复制完数据后，进入 docker 命令行：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 139)">exec</span><span class="token plain"> -it mongodb-name </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span></div></code></pre></div><p class="css-1msd9hy">之后，进入复制 json 文件路径，执行 mongorestore 命令：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">mongorestore -d database-name ./ --username</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">user --password</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">password</span></div></code></pre></div><p class="css-1msd9hy">mongorestore 官方指南： <a href="https://docs.mongodb.com/manual/reference/program/mongorestore/" class="css-1bw77fa">https://docs.mongodb.com/manual/reference/program/mongorestore/</a></p><h2 class="css-kih3f7">Docker + WordPress 微服务</h2><p class="css-1msd9hy"><a href="http://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html" class="css-1bw77fa">http://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html</a></p><h2 class="css-kih3f7">Docker Compose</h2><p class="css-1msd9hy">Compose 是一个用于管理多个 Docker 容器组成一个应用的工具。</p><p class="css-1msd9hy">Compose 配置文件是 YAML 格式的 docker-compose.yml。</p><p class="css-1msd9hy">写好多个容器之间的调用关系 .yml 配置文件后，只需要一个命令，就能同时启动/关闭这些容器。</p><p class="css-1msd9hy">Mac 和 Windows 在安装 docker 的时候，会一起安装 docker compose。Linux 系统下的安装参考官方文档。</p><p class="css-1msd9hy">安装完成后，运行命令查询：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker-compose --version</span></div></code></pre></div><p class="css-1msd9hy">compose wordpress 示例 yml</p><div class="gatsby-highlight" data-language="yml"><pre class="prism-code language-yml" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-yml"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token key atrule">mysql</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">  </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token number" style="color:rgb(247, 140, 108)">5.7</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">  </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> MYSQL_ROOT_PASSWORD=123456</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> MYSQL_DATABASE=wordpress</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain"></span><span class="token key atrule">web</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">  </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> wordpress</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">  </span><span class="token key atrule">links</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> mysql</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">  </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> WORDPRESS_DB_PASSWORD=123456</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">  </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;127.0.0.3:8080:80&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">  </span><span class="token key atrule">working_dir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /var/www/html</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">  </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> wordpress</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">/var/www/html</span></div></code></pre></div><p class="css-1msd9hy">启动两个容器：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker-compose up</span></div></code></pre></div><p class="css-1msd9hy">关闭两个容器：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker-compose stop</span></div></code></pre></div><p class="css-1msd9hy">关闭后，两个容器还在，数据不会丢失，下次启动时，还可以复用。</p><p class="css-1msd9hy">删除容器文件（容器必须已经停止）：</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-1ifvhg3">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">docker-compose </span><span class="token function" style="color:rgb(130, 170, 255)">rm</span></div></code></pre></div><h2 class="css-kih3f7">MySQL 网页客户端 Docker 容器 - Adminer</h2></section><footer class="post-footer"><a class="css-bpdkdn" href="/tags/notes"><span class="m-1 bg-gray-200 hover:bg-gray-300 rounded-full px-2 font-bold text-sm leading-loose cursor-pointer">#<!-- -->notes</span></a>, <a class="css-bpdkdn" href="/tags/docker"><span class="m-1 bg-gray-200 hover:bg-gray-300 rounded-full px-2 font-bold text-sm leading-loose cursor-pointer">#<!-- -->docker</span></a>, <a class="css-bpdkdn" href="/tags/linux"><span class="m-1 bg-gray-200 hover:bg-gray-300 rounded-full px-2 font-bold text-sm leading-loose cursor-pointer">#<!-- -->linux</span></a></footer></main><style data-emotion="css y7pay1">.css-y7pay1{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:8rem;color:var(--theme-ui-colors-secondary);-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border-top-style:solid;border-top-width:1px;border-top-color:var(--theme-ui-colors-divide);padding-top:1rem;}.css-y7pay1 a{color:var(--theme-ui-colors-secondary);-webkit-text-decoration:none;text-decoration:none;}.css-y7pay1 a:hover{color:var(--theme-ui-colors-heading);-webkit-text-decoration:underline;text-decoration:underline;}.css-y7pay1 a:focus{color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-y7pay1{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}@media screen and (min-width: 768px){.css-y7pay1{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><footer class="css-y7pay1"><div>© <!-- -->2022<!-- --> by <!-- -->BEIHAI Blog<!-- -->. All rights reserved.</div><div><style data-emotion="css 1fmmdck">.css-1fmmdck{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1fmmdck:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a aria-label="Link to the theme&#x27;s GitHub repository" href="https://github.com/LekoArts/gatsby-themes/tree/main/themes/gatsby-theme-minimal-blog" class="css-1fmmdck">Theme</a> <!-- -->by<!-- --> <a aria-label="Link to the theme author&#x27;s website" href="https://www.lekoarts.de?utm_source=minimal-blog&amp;utm_medium=Theme" class="css-1fmmdck">LekoArts</a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><span style="position:absolute;overflow:hidden;clip:rect(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;border:0"><span aria-hidden="true" style="position:absolute;overflow:hidden;clip:rect(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;border:0;font-family:&quot;&#x27;Noto Sans SC&#x27;, sans-serif&quot;"> </span></span><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/linux-install-and-use-docker";window.___webpackCompilationHash="feca5a58659cd4d59e11";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-d61253794eba68653921.js"],"app":["/app-15bb8988e3d4ff32065b.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx-6f188b0f4d7fd6fbc37a.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx-fb1a760fe41f22295616.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-74f4e62b0574fd6e3268.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-0ba29a80fd0bb999f086.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx-5dfd077513440fa76278.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx-a2e112944461eea43add.js"],"component---src-pages-404-jsx":["/component---src-pages-404-jsx-d962e5dd54886764f580.js"]};/*]]>*/</script><script src="/polyfill-d61253794eba68653921.js" nomodule=""></script><script src="/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-0ba29a80fd0bb999f086.js" async=""></script><script src="/076b648d06f94fa0e68f4094bcf9c1a72c93f983-bdeab7b9cef700a010e4.js" async=""></script><script src="/app-15bb8988e3d4ff32065b.js" async=""></script><script src="/framework-de026f80c4152d2570ec.js" async=""></script><script src="/webpack-runtime-050af6b145167609215a.js" async=""></script></body></html>